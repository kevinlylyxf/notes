- 复制粘贴
   - vim下每一个删除剪切操作都会把东西放到剪切板上去
   - y0,复制到当前行开始 y$,复制到当前行结束 yfn，复制到第一个n结束的位置
   - vim中的剪切板和系统的剪切板是隔开的，如果需要共享，可以设置set clipboard=unnamedplus,此时所有的剪切操作都会到系统剪切板里，如果只是想偶尔复制东西到系统剪切板，"+y可以将选中的东西复制到系统剪切板，如果没有在可视模式下选中，那就是光标所在的当前行。
   - vim中的寄存器有很多，类型各不相同，有未命名寄存器，数字寄存器存储的是c、d、x删除的文本，其不断被覆盖，文本寄存器a-z存储的是复制的文本，用"ay来复制到a，"Ay,就是将新复制的添加到a寄存器后面，b类似，要用B添加。粘贴时要指明寄存器"ap

### 一堆set

- ```
  set number显示行号
  set nonumber取消行号
  ```

- ```
  set ruler 打开标尺选项(ruler option)。将在屏幕右下角，显示当前所在的行和列，以及相对于整个文件所处的位置。
  ```

- ```
  set ignorecase忽略大小写
  set noignorecase重新设置为大小写敏感
  set smartcase
  在设置了ignorecase选项后，我们查找字符串word，则会同时匹配word、Word，WORD等；如果我们查找字符串WORD，匹配的结里也是一样的。但是如果设置了:set ignorecase和:set smartcase两项之后，就会执行不同的匹配模式：如果输入的是小写字符，那么就会匹配各种可能的组合，与ignorecase选项的情况相同；但是如果在输入中有一个大写字符，那么这时就会转变为精确查找，与noignorecase选项的情况相同。
  ```

- ```
  set hlsearch设置高亮显示查找的文本
  set nohlsearch关闭高亮显示
  set incsearch打开自动匹配选项
  set noincsearch关闭自动匹配选项
  set nowrapscan禁止循环查找
  set wrapscan启用循环查找
  ```

  

### 基础知识

##### 基本编辑

- 使用i命令，将在当前字符的左边新增文本。而使用I命令，则在当前行的开头新增文本
- 使用a命令，可以在当前光标所在的字符后面进入插入状态，而A命令，则是在一行的末尾进入插入状态
- 使用o命令，可以在当前行的下面新增一行并进入插入模式；而使用O命令，则可以在当前行的上一行新增一行并进入插入模式。
- 使用x命令，删除当前字符。也可以使用X命令，删除当前光标前的一个字符。将数字和命令组合则可以一次删除多个字符。例如3x命令，则可以删除3个字符。
- 使用dd命令，可以删除整个当前行。而D命令，则只删除当前光标到本行结尾的所有文字。
- 如果我们想要恢复先前的改动，那么可以使用u命令来撤销上一次的修改；而U命令则将撤销进入当前行以后对该行做的所有修改。当光标离开该行之后，就无法再用此命令恢复在该行的操作了。如果我们想要重做某些工作，那么可以使用CTRL+R命令。
- Vim命令中的前导冒号将使光标移动到屏幕底端最后一行的下面，随后键入的命令也随之显示在屏幕上，按回车键将执行此命令。如果需要取消一个冒号命令，则需要重复按ESC键或CTRL+H，直到光标返回到文档的最后一行。输入：可以输入命令，如果想取消需要按两次ESC或者按组合键CTRL+H

##### 移动

###### 行内移动

- w命令向前移动一个单词，用b命令向后移动一个单词。我们也可以用数字做前缀组成新的命令，来快速的移动。例如4w就是向前移动4个单词，而5b则是向后移动5个单词。
- 命令e也是向前移到一个单词，但是将光标定位在单词的结尾处；命令ge则是向后移到一个单词并到达前一个单词的结尾处。
- 利用$命令可以使光标移到一行的结尾处；而g_命令则会而将光标移到一行的最后一个非空字符处。
- 利用0命令可以使光标移到一行的开始处。而^命令则会忽略开头的空格，而将光标移到一行的第一个字符处。

###### 行间移动

- 进入命令状态，直接输入行号，按下回车键就可以移动到指定的行。
- 使用G命令，可以移动到指定的行。例如3G可以使我们快速的移到第3行。而1G则可以使我们移到文章的最顶端，而G则是定位到文章的最后一行。
- 使用-命令，可以移动到上一行的第一个非空字符处；而+命令，则可以移动到下一行的第一个非空字符处。
- 使用)命令，可以向前移动一个句子；而(命令，则可以向后移动一个句子。
- 使用}命令，可以向前移动一个段落；而{命令，则向后移动一个段落。
- 除了在行间移动，我们还可以使用ctrl+U和ctrl+D命令进行向上和向下翻页，以快速移动到文章的不同部分。
- 执行:jumps命令，就会看到一个曾到过的行的列表。使用命令CTRL-O跳转到移动记录列表中上一个位置。而命令CTRL-I跳转到移动记录列表中下一个位置。你不但可以在当前文件内跳转，甚至还可以移动到曾经涉足过的其它文件。这个CTRL-O可以直接使用，不用先输入jumps

###### 显示位置信息

- 即使没有显示行号，也可以使用CTRL-G命令在屏幕的下端显示当前所在位置的信息。我们还可以在CTRL-G命令加上一个数字参数，这个数字越大得到的信息就越详细。命令1CTRL-G会显示文件的全路径。命令2CTRL-G会同时显示缓冲区的数字标号。
- 命令gCTRL-G可显示出当前文件中的字符数的信息。主要显示出当前行数（Line）、列数（Col）、字数（Word）、字符数（Char）和字节数（Byte）等信息。

##### 复制和粘贴

- 在Vim中，我们使用寄存器（register)概念进行多次的剪切和粘贴操作。通常编辑器中只有一个剪切板可供使用，而在Vim中最多时可以使用26个剪切板，这样就会大大提高工作的效率。

###### 删除文本的保存

- 当我们使用d或x删除文本时，被删除掉的文本并没有被Vim所丢弃，而是被保存在寄存器之中。我们可以使用p命令来粘贴刚刚所删掉的内容。
- 下面来看看他是如何工作的。首先随意输入几行文本，然后移动到其中的一行，用dd命令来删掉一行。接着将光标移到任意位置，使用p命令，就会在当前光标的下一行粘贴被删除掉的内容。使用x命令删除的东西也可以粘贴回来。所不同的是在当前光标处之后粘贴。有了这样的命令，我们就可以轻松找回刚刚误删除的内容了。可以理解为如果是一行的内容用p命令就是在下一行，如果不是一行的内容就是在当前光标之后粘贴

###### 复制

- 在Vim中使用y命令（yank）进行复制操作。yw命令可以复制一个单词。yy命令可以复制一行。我们也可以使用Y命令来复制一行，或者使用数字做前缀来指定复制多行。使用y$命令，则可以复制从当前光标到本行结尾的所有字符。
- 如果我们在某一行用ma做了标记（mark），那么就可以使用y'a命令来复制这一行了。

###### 粘贴

- 在完成复制之后，即可以使用p命令进行粘贴。p命令可以在一个文件中多次使用，每次都可以将刚删除或复制的内容重复粘贴在所希望的地方。当然这个命令也可以使用数字做前缀，明确的指出所要执行的次数。
- 小写的p命令是在当前行的下一行进行粘贴,，并将光标移到新插入行的开头处。
- 大写的P命令则是在当前的上一行进行插入，并将光标移到新插入行的开头处。
- gp命令是在当前行的下一行进行粘贴，并将光标移动到新插入行的下一行的开头处。
- gP命令是在当前的上一行进行粘贴，插入后光标移动新插入行的下一行的开头处。

##### 查找文本

###### 查找字符

- 命令f用于在本行内向前搜索。例如fx是向前（Forward）搜索字母x。而命令F是向后（Backward）搜索。例如Fx是向后搜索字母x。与f和F这两个相类似的是t和T命令。t命令类似于f向前搜索命令，所不同的是t搜索到时并不是将光标停在目标字符上，而是停在目标字符的前一个字符上。而T命令类似于F向后搜索命令，所不同的是T搜索到时并不是将光标停在目标字符上，而是停在目标字符的后一个字符上。
- 对于以上四个查找命令，我们可以重复执行这些操作。命令;是按照前一次的查找方向继续查找，如果要向相反的方向查找可以使用,命令。但是这些查找只是在行本行内进行，并不会将光标移动到其它的行。

###### 查找字符串

- 使用/string命令，可以向前（Forward）查找字符串string，按下回车后，光标就能跳转到匹配处。如果在整个文件中有多处匹配的内容，那么可以使用/命令，然后按下回车键继续刚才的查找。我们还可以使用n命令来继续刚才的查找命令。
- 我们也可以使用?string命令向后（Backward）查找。N也是逆向查找命令，他可以实现立即反向查找。
- 如果我们想要停止这一查找，可以使用ctrl+C命令
- Vim具有自动记录查找命令历史的功能，这样就不用重复输入查找命令了。例如你刚才做过的三次查找分别是：/one，/two，/three。而现在输入/，然后按上下方向键，就可以在屏幕底部看到刚才查找命令，这时只要按下回车就能够再次执行之前的查找命令了。

###### 指定光标放置位置

- 在默认情况下，Vim会将光标放在第一个匹配结果的开始处。例如你查找字符串set，光标将会停留在字母s之上。我们可以在命令中指定查找结束后光标停留的位置。
- 对于向前查找的命令，可以在斜线后用数字来指明光标所处的位置，例如/set/2或/set/+2命令都会在查找结束后将光标放在第一个set字符串之后第二行的开始处。命令中的数字可以是正数也可以是负数。如果仅是一个简单的数字，光标会被放在第一个匹配字符串之后或之前的数字所指定的行的开始处。正数表示是向后，而负数表示是向前。
- 参数b（begin）或s（start）会使得光标放在第一个匹配字符串的开头处。如果斜线后是b和数字，那么在查找结束后，光标将会放在第一个匹配字符串的开始处，然后向左或是右移动n个字符，这里的n即为数字所指定的数。如果为正数则是向右移动，如果是负数则是向左移动。例如/set/b2或/set/s+2命令，将使光标在查找结束后放在第一个匹配字符的开始处，然后向右移动两个字符，也就是说最后光标会位于第一个匹配字符串中的t的位置。将b改为s也是一样的效果。
- 而参数e会使得光标放在第一个匹配字符串的结尾处。同样我们也可以用数字来指定向右还是向左移动光标以及移动的字符数。例如/set/e命令会使光标放在第一个匹配字符处的结尾处。如果命令改为/set/e2，会将光标放在第一个匹配字符串的结尾处，然后向右移动2个字符。这里的数字如果是正数则向右移，如果为负数则向左移。
- 我们还可以在命令中指定偏移量。例如命令/set/e+2是在查找set字符串结束后，将光标放在第一个匹配字符串的结尾处，然后向右移动两个字符。/命令，将使用相同的偏移量重复前一次的查找。如果要重复前一次的查找，但是需要不同的偏移量，那么可以使用//5命令。如果不使用偏移量，则可以指明一个空的偏移量，如//命令。
- 查找命令?也可以实现类似的功能。例如?set?b5命令，是将光标放在最后一个匹配字符串的开头部分，然后向右移动5个字符。??-2命令，则继续前一次的查找命令，但是使用新的偏移量。??命令，是继续前一次的查找命令，但是不使用偏移量。

###### 立时查找字符串

- 如果我们想快速查找当前光标下的字符串，可以使用命令*，这个命令可以向前查找与当前光标下的字符精确匹配的字符串。而命令#，则向后查找与当前光标下的字符串精确匹配的结果。
- 如果当前光标下的字符串为word，在执行*命令查找时并不会与Word相匹配。如果使用相类似的`g*`命令，来查找word，则不会要求严格的精确匹配，那么就有可能和Word相匹配。而g#命令与其相同，只不过他是向相反的方向进行查找匹配。

###### 大小写敏感

- 在默认情况下，Vim是大小写敏感的。如果文件中包含有include,INCLUDE,Include等多个字符串。当我们使用命令/include来查找时，则只有include字符会被高亮显示。但是如果我们使用:set ignorecase命令，设置为忽略大小写，则include,INCLUDE,Include所有字符串都会被高亮显示。当然我们也可以使用:set noignorecase命令，重新设置为大小写敏感。
- 在设置了ignorecase选项后，我们查找字符串word，则会同时匹配word、Word，WORD等；如果我们查找字符串WORD，匹配的结里也是一样的。但是如果设置了:set ignorecase和:set smartcase两项之后，就会执行不同的匹配模式：如果输入的是小写字符，那么就会匹配各种可能的组合，与ignorecase选项的情况相同；但是如果在输入中有一个大写字符，那么这时就会转变为精确查找，与noignorecase选项的情况相同。
- 我们也可以在执行查找命令时，使用修饰符来控制大小写敏感。在命令中加入修饰符\C将执行大小写敏感的查找，比如?\Cword命令就只匹配单词word。而在命令中加入修饰符\c则执行忽略大小写的查找。

###### 设置查找选项

- 我们可以使用:set hlsearch命令设置高亮显示查找的文本，而:set nohlsearch命令则会关闭高亮显示。
- 如果想要立刻清除上次查找产生的高亮显示，可以使用:nohlsearch命令。
- 使用:set incsearch命令，将打开自动匹配选项。在进行查找时就会显示出不断匹配的过程。例如你想查找的内容是include，在打开这个选项后，当你输入/i，光标定位在i上，再继续输入n光标定位在in上，以此类推自动显示匹配的结果。我们也可以使用:set noincsearch命令，来关闭自动匹配选项。
- 在默认情下，输入查找的字符串之后，vim是从当前光标处向前查找，直到文件的结尾；如果没有找到，则会从文件的开头开始查找，直到光标所处的位置。通过:set nowrapscan命令，可以禁止这种循环查找的方式。如果已经查找到文件的结尾仍未发现匹配结果时，就会在底部显示出一条错误信息。如果想要重新启用循环查找方式，可以使用:set wrapscan命令进行设置。

##### 替换

- 利用:substitute命令，可以将指定的字符替换成其他字符。通常，我们会使用命令的缩写形式:s，格式如下：

  ```
  :[range] s/search/replace/[flags] [count]
  ```

  - *range*是指定范围，也就是在哪些行里做替换。而后是将字符串from替换成字符串to。

###### 替换标记

- 在默认情况下，替换命令仅将本行中第一个出现的的字符替换成给定字符。如果我们想要将所有出现的字符都替换成给定字符，可以在命令中使用*g*（global）标记：

  ```
  :%s/from/to/g
  ```

- 其他的标记（flags）包括：*p*（print），是要求打印所做的改动；*c*（confirm），是要求在做出改动以前先询问；*i*（ignorecase），是不区分大小写。我们可以组合使用标记，比如以下命令，将会显示将要做改动的文本并要求确认：

  ```
  :1,$ s/Professor/Teacher/gc
  
  replace with Teacher (y/n/a/q/l/^E/^Y)?
  
  这时你可以做出以下回答：
  
  y Yes：执行这个替换
  n No：取消这个替换
  a All：执行所有替换而不要再询问
  q Quit：退出而不做任何改动
  l Last：替换完当前匹配点后退出
  CTRL-E 向上翻滚一行
  CTRL-Y 向下翻滚一行
  ```

###### 指定范围

- 如果没有在命令中指定范围，那么将只会在当前行进行替换操作。以下命令将把当前行中的I替换为We。命令中的/i标记，用于指定区分大小写。

  ```
  :s/I/We/gi
  ```
- 以下命令将文中所有的字符串idiots替换成managers：

```
:1,$s/idiots/manages/g
```

- 通常我们会在命令中使用%指代整个文件做为替换范围：

```
:%s/search/replace/g
```

- 以下命令指定只在第5至第15行间进行替换:

```
:5,15s/dog/cat/g
```

- 以下命令指定只在当前行在内的以下4行内进行替换：

```
:s/helo/hello/g4
```

- 以下命令指定只在当前行至文件结尾间进行替换:

```
:.,$s/dog/cat/g
```

- 以下命令指定只在后续9行内进行替换:

  ```
  :.,.+8s/dog/cat/g
  ```

- 你还可以将特定字符做为替换范围。比如，将SQL语句从FROM至分号部分中的所有等号（=）替换为不等号（<>）：

  ```
  :/FROM/,/;/s/=/<>/g
  ```

- 在[可视化模式](https://link.zhihu.com/?target=http%3A//yyq123.blogspot.com/2010/11/vim-visual-mode.html)下，首先选择替换范围, 然后输入:进入命令模式，就可以利用s命令在选中的范围内进行文本替换。

###### 精确替换

- 在搜索*sig*时，也将匹配*sig*, *signature*, *signing*等多个单词。如果希望精确替换某个单词，可以使用“\<”来匹配单词的开头，并用“\>”来匹配单词的结尾：

  ```
  :s/\<term\>/replace/gc
  ```

###### 多项替换

- 如果想要将单词*Kang*和*Kodos*都替换为*alien*，那么可以使用|进行多项替换。

  ```
  :%s/Kang\|Kodos/alien/gc
  ```

###### 变量替换

- 使用以下命令可以将文字替换为变量的内容：

  ```
  :%s!\~!\= expand($HOME)!g
  ```

##### 撤销

###### 单线撤销

- 在Normal mode下使用u命令，或者在Command mode下使用:undo命令，可以撤销上一次的操作。

- 使用U命令，可以撤销所有针对当前行最近所做的修改。

- Vim可以进行多次撤销，这个次数是由选项undolevels来指定的。例如我们可以使用以下命令，设置撤消次数为5000：

  ```
  :set undolevels=5000
  ```

- 如果希望重做被撤销的操作，可以使用:redo或CTRL-R命令。

###### 分支撤销

- 以下述操作为例：新建文件并输入“大象”，然后在新的一行中输入“小牛”，返回Normal mode并按下u命令。这时输入“小牛”的操作被撤消，文件将只包含“大象”。接着输入“猩猩”，然后返回Normal mode并按下u命令，此时将撤消输入“猩猩”的操作，文件仍然只包含“大象”。所以你的“小牛”就再也找不回来了。而撤消分支（Undo branches）就可以解决这个问题。使用g-可以使文件重新包含入“大象”和“小牛”

  ![](https://pic2.zhimg.com/80/v2-c5e38593c67c4751cfa2892f50f94275_1440w.png)

- 如果你先撤销了若干改变，然后又进行了一些其它的改变。此时，被撤销的改变就成为一个分支。我们可以使用:undolist命令查看修改的各个分支。

  ![](https://pic1.zhimg.com/80/v2-692ec9c6942ac0c886ecafd5c4149b68_1440w.png)
  - "编号" 列是改变号。这个编号持续增加，用于标识特定可撤销的改变。
  - "改变" 列是根结点到此叶结点所需的改变数目。
  - "时间" 列是此改变发生的时间。

- 使用:undo命令并指定编号做为参数，则能够撤销到某个分支。

- 通过在不同的撤消分支间跳转，使用g-命令能够回到较早的文本状态；而g+命令则返回较新的文本状态。

- 我们还可以根据时间撤消操作：使用:earlier 10m命令退回到10分钟前的文本状态。也可以用:later 5s命令跳转到5秒以后的编辑状态。命令参数中的"s"代表秒，"m"代表分钟，"h"代表小时。

- 使用:help undo-tree和:help usr_32.txt命令，可以查看撤消操作的帮助信息。

##### 帮助信息

- 在帮助信息中的命令、选项或章节等链接上双击鼠标或点击ctrl-]键，就可以跳转到相关的帮助信息。点击ctrl-o或ctrl-t则可以在查阅过的帮助信息之间进行跳转。

- 使用以下命令，可以显示用户手册的目录：

  ```
  help usr_toc
  ```

- 通过set wildmenu设置命令，可以在窗口底部显示菜单选项。当我们并不知道确切的命令名称时，可以只输入开头的几个字母，然后按下Tab键，就将在wildmenu中显示可能匹配的命令。继续按Tab键，可以在这些命令列表间移动

- 使用:help ctrl<Tab>命令，可以列出所有和CTRL键相关的帮助主题。使用:help i_CTRL-R命令，则只显示在插入模式下CTRL-R的帮助信息；而:help c_CTRL-R命令，则显示在常规模式下CTRL-R的帮助信息。

###### 模糊查询

- 如果不知道具体的命令名称，那么可以使用以下命令在所有帮助文件中查询相关信息。例如，使用此命令，将逐一显示所有与插入模式相关的帮助信息。

  ```
  :helpgrep insert mode
  ```

- 可以使用:cnext命令，查看下一条帮助信息；使用:cprev命令，查看上一条帮助信息。

- 如果有很多相关的帮助信息，可以使用:clist命令，列示所有包含指定主题的帮助信息。

- 使用:cwin命令，则可以在QuickFix窗口中列示所有相关帮助信息的条目。利用鼠标滚轴、方向键或j,k移动命令可以在条目间移动，按下回车键则可以打开当前条目的帮助信息。使用:cclose命令，可以关闭QuickFix窗口。

###### 更多帮助资源

- :help quickref命令，可以查看快速索引：
- :help tips命令，可以查看使用技巧
