- 复制粘贴
   - vim下每一个删除剪切操作都会把东西放到剪切板上去
   - y0,复制到当前行开始 y$,复制到当前行结束 yfn，复制到第一个n结束的位置
   - vim中的剪切板和系统的剪切板是隔开的，如果需要共享，可以设置set clipboard=unnamedplus,此时所有的剪切操作都会到系统剪切板里，如果只是想偶尔复制东西到系统剪切板，"+y可以将选中的东西复制到系统剪切板，如果没有在可视模式下选中，那就是光标所在的当前行。
   - vim中的寄存器有很多，类型各不相同，有未命名寄存器，数字寄存器存储的是c、d、x删除的文本，其不断被覆盖，文本寄存器a-z存储的是复制的文本，用"ay来复制到a，"Ay,就是将新复制的添加到a寄存器后面，b类似，要用B添加。粘贴时要指明寄存器"ap

### 一堆set

- ```
  set number显示行号
  set nonumber取消行号
  ```

- ```
  set ruler 打开标尺选项(ruler option)。将在屏幕右下角，显示当前所在的行和列，以及相对于整个文件所处的位置。
  ```

- ```
  set ignorecase忽略大小写
  set noignorecase重新设置为大小写敏感
  set smartcase
  在设置了ignorecase选项后，我们查找字符串word，则会同时匹配word、Word，WORD等；如果我们查找字符串WORD，匹配的结里也是一样的。但是如果设置了:set ignorecase和:set smartcase两项之后，就会执行不同的匹配模式：如果输入的是小写字符，那么就会匹配各种可能的组合，与ignorecase选项的情况相同；但是如果在输入中有一个大写字符，那么这时就会转变为精确查找，与noignorecase选项的情况相同。
  ```

- ```
  set hlsearch设置高亮显示查找的文本
  set nohlsearch关闭高亮显示
  set incsearch打开自动匹配选项
  set noincsearch关闭自动匹配选项
  set nowrapscan禁止循环查找
  set wrapscan启用循环查找
  ```

  

### 基础知识

##### 基本编辑

- 使用i命令，将在当前字符的左边新增文本。而使用I命令，则在当前行的开头新增文本
- 使用a命令，可以在当前光标所在的字符后面进入插入状态，而A命令，则是在一行的末尾进入插入状态
- 使用o命令，可以在当前行的下面新增一行并进入插入模式；而使用O命令，则可以在当前行的上一行新增一行并进入插入模式。
- 使用x命令，删除当前字符。也可以使用X命令，删除当前光标前的一个字符。将数字和命令组合则可以一次删除多个字符。例如3x命令，则可以删除3个字符。
- 使用dd命令，可以删除整个当前行。而D命令，则只删除当前光标到本行结尾的所有文字。
- 如果我们想要恢复先前的改动，那么可以使用u命令来撤销上一次的修改；而U命令则将撤销进入当前行以后对该行做的所有修改。当光标离开该行之后，就无法再用此命令恢复在该行的操作了。如果我们想要重做某些工作，那么可以使用CTRL+R命令。
- Vim命令中的前导冒号将使光标移动到屏幕底端最后一行的下面，随后键入的命令也随之显示在屏幕上，按回车键将执行此命令。如果需要取消一个冒号命令，则需要重复按ESC键或CTRL+H，直到光标返回到文档的最后一行。输入：可以输入命令，如果想取消需要按两次ESC或者按组合键CTRL+H

##### 移动

###### 行内移动

- w命令向前移动一个单词，用b命令向后移动一个单词。我们也可以用数字做前缀组成新的命令，来快速的移动。例如4w就是向前移动4个单词，而5b则是向后移动5个单词。
- 命令e也是向前移到一个单词，但是将光标定位在单词的结尾处；命令ge则是向后移到一个单词并到达前一个单词的结尾处。
- 利用$命令可以使光标移到一行的结尾处；而g_命令则会而将光标移到一行的最后一个非空字符处。
- 利用0命令可以使光标移到一行的开始处。而^命令则会忽略开头的空格，而将光标移到一行的第一个字符处。

###### 行间移动

- 进入命令状态，直接输入行号，按下回车键就可以移动到指定的行。

- 使用G命令，可以移动到指定的行。例如3G可以使我们快速的移到第3行。而1G则可以使我们移到文章的最顶端，而G则是定位到文章的最后一行。

- 使用-命令，可以移动到上一行的第一个非空字符处；而+命令，则可以移动到下一行的第一个非空字符处。

- 使用)命令，可以向前移动一个句子；而(命令，则可以向后移动一个句子。

- 使用}命令，可以向前移动一个段落；而{命令，则向后移动一个段落。

- 除了在行间移动，我们还可以使用ctrl+U和ctrl+D命令进行向上和向下翻页，以快速移动到文章的不同部分。

- 执行:jumps命令，就会看到一个曾到过的行的列表。使用命令CTRL-O跳转到移动记录列表中上一个位置。而命令CTRL-I跳转到移动记录列表中下一个位置。你不但可以在当前文件内跳转，甚至还可以移动到曾经涉足过的其它文件。这个CTRL-O可以直接使用，不用先输入jumps

  ![](https://pic2.zhimg.com/80/v2-1c0291d48e3b7d427c1a128742aaa1f5_720w.png)

###### 显示位置信息

- 即使没有显示行号，也可以使用CTRL-G命令在屏幕的下端显示当前所在位置的信息。我们还可以在CTRL-G命令加上一个数字参数，这个数字越大得到的信息就越详细。命令1CTRL-G会显示文件的全路径。命令2CTRL-G会同时显示缓冲区的数字标号。
- 命令gCTRL-G可显示出当前文件中的字符数的信息。主要显示出当前行数（Line）、列数（Col）、字数（Word）、字符数（Char）和字节数（Byte）等信息。

##### 复制和粘贴

- 在Vim中，我们使用寄存器（register)概念进行多次的剪切和粘贴操作。通常编辑器中只有一个剪切板可供使用，而在Vim中最多时可以使用26个剪切板，这样就会大大提高工作的效率。

###### 删除文本的保存

- 当我们使用d或x删除文本时，被删除掉的文本并没有被Vim所丢弃，而是被保存在寄存器之中。我们可以使用p命令来粘贴刚刚所删掉的内容。
- 下面来看看他是如何工作的。首先随意输入几行文本，然后移动到其中的一行，用dd命令来删掉一行。接着将光标移到任意位置，使用p命令，就会在当前光标的下一行粘贴被删除掉的内容。使用x命令删除的东西也可以粘贴回来。所不同的是在当前光标处之后粘贴。有了这样的命令，我们就可以轻松找回刚刚误删除的内容了。可以理解为如果是一行的内容用p命令就是在下一行，如果不是一行的内容就是在当前光标之后粘贴

###### 复制

- 在Vim中使用y命令（yank）进行复制操作。yw命令可以复制一个单词。yy命令可以复制一行。我们也可以使用Y命令来复制一行，或者使用数字做前缀来指定复制多行。使用y$命令，则可以复制从当前光标到本行结尾的所有字符。
- 如果我们在某一行用ma做了标记（mark），那么就可以使用y'a命令来复制这一行了。

###### 粘贴

- 在完成复制之后，即可以使用p命令进行粘贴。p命令可以在一个文件中多次使用，每次都可以将刚删除或复制的内容重复粘贴在所希望的地方。当然这个命令也可以使用数字做前缀，明确的指出所要执行的次数。
- 小写的p命令是在当前行的下一行进行粘贴,，并将光标移到新插入行的开头处。
- 大写的P命令则是在当前的上一行进行插入，并将光标移到新插入行的开头处。
- gp命令是在当前行的下一行进行粘贴，并将光标移动到新插入行的下一行的开头处。
- gP命令是在当前的上一行进行粘贴，插入后光标移动新插入行的下一行的开头处。

##### 查找文本

###### 查找字符

- 命令f用于在本行内向前搜索。例如fx是向前（Forward）搜索字母x。而命令F是向后（Backward）搜索。例如Fx是向后搜索字母x。与f和F这两个相类似的是t和T命令。t命令类似于f向前搜索命令，所不同的是t搜索到时并不是将光标停在目标字符上，而是停在目标字符的前一个字符上。而T命令类似于F向后搜索命令，所不同的是T搜索到时并不是将光标停在目标字符上，而是停在目标字符的后一个字符上。
- 对于以上四个查找命令，我们可以重复执行这些操作。命令;是按照前一次的查找方向继续查找，如果要向相反的方向查找可以使用,命令。但是这些查找只是在行本行内进行，并不会将光标移动到其它的行。

###### 查找字符串

- 使用/string命令，可以向前（Forward）查找字符串string，按下回车后，光标就能跳转到匹配处。如果在整个文件中有多处匹配的内容，那么可以使用/命令，然后按下回车键继续刚才的查找。我们还可以使用n命令来继续刚才的查找命令。
- 我们也可以使用?string命令向后（Backward）查找。N也是逆向查找命令，他可以实现立即反向查找。
- 如果我们想要停止这一查找，可以使用ctrl+C命令
- Vim具有自动记录查找命令历史的功能，这样就不用重复输入查找命令了。例如你刚才做过的三次查找分别是：/one，/two，/three。而现在输入/，然后按上下方向键，就可以在屏幕底部看到刚才查找命令，这时只要按下回车就能够再次执行之前的查找命令了。

###### 指定光标放置位置

- 在默认情况下，Vim会将光标放在第一个匹配结果的开始处。例如你查找字符串set，光标将会停留在字母s之上。我们可以在命令中指定查找结束后光标停留的位置。
- 对于向前查找的命令，可以在斜线后用数字来指明光标所处的位置，例如/set/2或/set/+2命令都会在查找结束后将光标放在第一个set字符串之后第二行的开始处。命令中的数字可以是正数也可以是负数。如果仅是一个简单的数字，光标会被放在第一个匹配字符串之后或之前的数字所指定的行的开始处。正数表示是向后，而负数表示是向前。
- 参数b（begin）或s（start）会使得光标放在第一个匹配字符串的开头处。如果斜线后是b和数字，那么在查找结束后，光标将会放在第一个匹配字符串的开始处，然后向左或是右移动n个字符，这里的n即为数字所指定的数。如果为正数则是向右移动，如果是负数则是向左移动。例如/set/b2或/set/s+2命令，将使光标在查找结束后放在第一个匹配字符的开始处，然后向右移动两个字符，也就是说最后光标会位于第一个匹配字符串中的t的位置。将b改为s也是一样的效果。
- 而参数e会使得光标放在第一个匹配字符串的结尾处。同样我们也可以用数字来指定向右还是向左移动光标以及移动的字符数。例如/set/e命令会使光标放在第一个匹配字符处的结尾处。如果命令改为/set/e2，会将光标放在第一个匹配字符串的结尾处，然后向右移动2个字符。这里的数字如果是正数则向右移，如果为负数则向左移。
- 我们还可以在命令中指定偏移量。例如命令/set/e+2是在查找set字符串结束后，将光标放在第一个匹配字符串的结尾处，然后向右移动两个字符。/命令，将使用相同的偏移量重复前一次的查找。如果要重复前一次的查找，但是需要不同的偏移量，那么可以使用//5命令。如果不使用偏移量，则可以指明一个空的偏移量，如//命令。
- 查找命令?也可以实现类似的功能。例如?set?b5命令，是将光标放在最后一个匹配字符串的开头部分，然后向右移动5个字符。??-2命令，则继续前一次的查找命令，但是使用新的偏移量。??命令，是继续前一次的查找命令，但是不使用偏移量。

###### 立时查找字符串

- 如果我们想快速查找当前光标下的字符串，可以使用命令*，这个命令可以向前查找与当前光标下的字符精确匹配的字符串。而命令#，则向后查找与当前光标下的字符串精确匹配的结果。
- 如果当前光标下的字符串为word，在执行*命令查找时并不会与Word相匹配。如果使用相类似的`g*`命令，来查找word，则不会要求严格的精确匹配，那么就有可能和Word相匹配。而g#命令与其相同，只不过他是向相反的方向进行查找匹配。

###### 大小写敏感

- 在默认情况下，Vim是大小写敏感的。如果文件中包含有include,INCLUDE,Include等多个字符串。当我们使用命令/include来查找时，则只有include字符会被高亮显示。但是如果我们使用:set ignorecase命令，设置为忽略大小写，则include,INCLUDE,Include所有字符串都会被高亮显示。当然我们也可以使用:set noignorecase命令，重新设置为大小写敏感。
- 在设置了ignorecase选项后，我们查找字符串word，则会同时匹配word、Word，WORD等；如果我们查找字符串WORD，匹配的结里也是一样的。但是如果设置了:set ignorecase和:set smartcase两项之后，就会执行不同的匹配模式：如果输入的是小写字符，那么就会匹配各种可能的组合，与ignorecase选项的情况相同；但是如果在输入中有一个大写字符，那么这时就会转变为精确查找，与noignorecase选项的情况相同。
- 我们也可以在执行查找命令时，使用修饰符来控制大小写敏感。在命令中加入修饰符\C将执行大小写敏感的查找，比如?\Cword命令就只匹配单词word。而在命令中加入修饰符\c则执行忽略大小写的查找。

###### 设置查找选项

- 我们可以使用:set hlsearch命令设置高亮显示查找的文本，而:set nohlsearch命令则会关闭高亮显示。
- 如果想要立刻清除上次查找产生的高亮显示，可以使用:nohlsearch命令。
- 使用:set incsearch命令，将打开自动匹配选项。在进行查找时就会显示出不断匹配的过程。例如你想查找的内容是include，在打开这个选项后，当你输入/i，光标定位在i上，再继续输入n光标定位在in上，以此类推自动显示匹配的结果。我们也可以使用:set noincsearch命令，来关闭自动匹配选项。
- 在默认情下，输入查找的字符串之后，vim是从当前光标处向前查找，直到文件的结尾；如果没有找到，则会从文件的开头开始查找，直到光标所处的位置。通过:set nowrapscan命令，可以禁止这种循环查找的方式。如果已经查找到文件的结尾仍未发现匹配结果时，就会在底部显示出一条错误信息。如果想要重新启用循环查找方式，可以使用:set wrapscan命令进行设置。

##### 替换

- 利用:substitute命令，可以将指定的字符替换成其他字符。通常，我们会使用命令的缩写形式:s，格式如下：

  ```
  :[range] s/search/replace/[flags] [count]
  ```

  - *range*是指定范围，也就是在哪些行里做替换。而后是将字符串from替换成字符串to。

###### 替换标记

- 在默认情况下，替换命令仅将本行中第一个出现的的字符替换成给定字符。如果我们想要将所有出现的字符都替换成给定字符，可以在命令中使用*g*（global）标记：

  ```
  :%s/from/to/g
  ```

- 其他的标记（flags）包括：*p*（print），是要求打印所做的改动；*c*（confirm），是要求在做出改动以前先询问；*i*（ignorecase），是不区分大小写。我们可以组合使用标记，比如以下命令，将会显示将要做改动的文本并要求确认：

  ```
  :1,$ s/Professor/Teacher/gc
  
  replace with Teacher (y/n/a/q/l/^E/^Y)?
  
  这时你可以做出以下回答：
  
  y Yes：执行这个替换
  n No：取消这个替换
  a All：执行所有替换而不要再询问
  q Quit：退出而不做任何改动
  l Last：替换完当前匹配点后退出
  CTRL-E 向上翻滚一行
  CTRL-Y 向下翻滚一行
  ```

###### 指定范围

- 如果没有在命令中指定范围，那么将只会在当前行进行替换操作。以下命令将把当前行中的I替换为We。命令中的/i标记，用于指定区分大小写。

  ```
  :s/I/We/gi
  ```
- 以下命令将文中所有的字符串idiots替换成managers：

```
:1,$s/idiots/manages/g
```

- 通常我们会在命令中使用%指代整个文件做为替换范围：

```
:%s/search/replace/g
```

- 以下命令指定只在第5至第15行间进行替换:

```
:5,15s/dog/cat/g
```

- 以下命令指定只在当前行在内的以下4行内进行替换：

```
:s/helo/hello/g4
```

- 以下命令指定只在当前行至文件结尾间进行替换:

```
:.,$s/dog/cat/g
```

- 以下命令指定只在后续9行内进行替换:

  ```
  :.,.+8s/dog/cat/g
  ```

- 你还可以将特定字符做为替换范围。比如，将SQL语句从FROM至分号部分中的所有等号（=）替换为不等号（<>）：

  ```
  :/FROM/,/;/s/=/<>/g
  ```

- 在[可视化模式](https://link.zhihu.com/?target=http%3A//yyq123.blogspot.com/2010/11/vim-visual-mode.html)下，首先选择替换范围, 然后输入:进入命令模式，就可以利用s命令在选中的范围内进行文本替换。

###### 精确替换

- 在搜索*sig*时，也将匹配*sig*, *signature*, *signing*等多个单词。如果希望精确替换某个单词，可以使用“\<”来匹配单词的开头，并用“\>”来匹配单词的结尾：

  ```
  :s/\<term\>/replace/gc
  ```

###### 多项替换

- 如果想要将单词*Kang*和*Kodos*都替换为*alien*，那么可以使用|进行多项替换。

  ```
  :%s/Kang\|Kodos/alien/gc
  ```

###### 变量替换

- 使用以下命令可以将文字替换为变量的内容：

  ```
  :%s!\~!\= expand($HOME)!g
  ```

##### 撤销

###### 单线撤销

- 在Normal mode下使用u命令，或者在Command mode下使用:undo命令，可以撤销上一次的操作。

- 使用U命令，可以撤销所有针对当前行最近所做的修改。

- Vim可以进行多次撤销，这个次数是由选项undolevels来指定的。例如我们可以使用以下命令，设置撤消次数为5000：

  ```
  :set undolevels=5000
  ```

- 如果希望重做被撤销的操作，可以使用:redo或CTRL-R命令。

###### 分支撤销

- 以下述操作为例：新建文件并输入“大象”，然后在新的一行中输入“小牛”，返回Normal mode并按下u命令。这时输入“小牛”的操作被撤消，文件将只包含“大象”。接着输入“猩猩”，然后返回Normal mode并按下u命令，此时将撤消输入“猩猩”的操作，文件仍然只包含“大象”。所以你的“小牛”就再也找不回来了。而撤消分支（Undo branches）就可以解决这个问题。使用g-可以使文件重新包含入“大象”和“小牛”

  ![](https://pic2.zhimg.com/80/v2-c5e38593c67c4751cfa2892f50f94275_1440w.png)

- 如果你先撤销了若干改变，然后又进行了一些其它的改变。此时，被撤销的改变就成为一个分支。我们可以使用:undolist命令查看修改的各个分支。

  ![](https://pic1.zhimg.com/80/v2-692ec9c6942ac0c886ecafd5c4149b68_1440w.png)
  - "编号" 列是改变号。这个编号持续增加，用于标识特定可撤销的改变。
  - "改变" 列是根结点到此叶结点所需的改变数目。
  - "时间" 列是此改变发生的时间。

- 使用:undo命令并指定编号做为参数，则能够撤销到某个分支。

- 通过在不同的撤消分支间跳转，使用g-命令能够回到较早的文本状态；而g+命令则返回较新的文本状态。

- 我们还可以根据时间撤消操作：使用:earlier 10m命令退回到10分钟前的文本状态。也可以用:later 5s命令跳转到5秒以后的编辑状态。命令参数中的"s"代表秒，"m"代表分钟，"h"代表小时。

- 使用:help undo-tree和:help usr_32.txt命令，可以查看撤消操作的帮助信息。

##### 帮助信息

- 在帮助信息中的命令、选项或章节等链接上双击鼠标或点击ctrl-]键，就可以跳转到相关的帮助信息。点击ctrl-o或ctrl-t则可以在查阅过的帮助信息之间进行跳转。

- 使用以下命令，可以显示用户手册的目录：

  ```
  help usr_toc
  ```

- 通过set wildmenu设置命令，可以在窗口底部显示菜单选项。当我们并不知道确切的命令名称时，可以只输入开头的几个字母，然后按下Tab键，就将在wildmenu中显示可能匹配的命令。继续按Tab键，可以在这些命令列表间移动

- 使用:help ctrl<Tab>命令，可以列出所有和CTRL键相关的帮助主题。使用:help i_CTRL-R命令，则只显示在插入模式下CTRL-R的帮助信息；而:help c_CTRL-R命令，则显示在常规模式下CTRL-R的帮助信息。

###### 模糊查询

- 如果不知道具体的命令名称，那么可以使用以下命令在所有帮助文件中查询相关信息。例如，使用此命令，将逐一显示所有与插入模式相关的帮助信息。

  ```
  :helpgrep insert mode
  ```

- 可以使用:cnext命令，查看下一条帮助信息；使用:cprev命令，查看上一条帮助信息。

- 如果有很多相关的帮助信息，可以使用:clist命令，列示所有包含指定主题的帮助信息。

- 使用:cwin命令，则可以在QuickFix窗口中列示所有相关帮助信息的条目。利用鼠标滚轴、方向键或j,k移动命令可以在条目间移动，按下回车键则可以打开当前条目的帮助信息。使用:cclose命令，可以关闭QuickFix窗口。

###### 更多帮助资源

- :help quickref命令，可以查看快速索引：
- :help tips命令，可以查看使用技巧

### 高阶操作

##### 在词间移动

- Vim有单词（word）和字串（WORD）两种概念。word是指由iskeyword选项定义的字符串；而WORD则是指用空白符分隔的字符串。可以使用:help word和:help WORD命令，查看更多帮助信息。

###### 在word间移动

- [count]b 向后移动count个words

  [count]e 向前移动count个words,并且将光标置于word的末尾.

  [count]ge 向后移动count个words,并且将光标置于WORD的末尾.

  [count]w 向前移动count个words.

- 按照通常的定义，单词是一系列字母的组合。然而在C程序中，则认为字母、数字和下划线来组成一个单词，比如size56就会被认为是一个单词。但是在LISP程序中，可以在变量名中使用-，这时会认为total-size是一个单词，而在C程序中这却会被认为是两个单词。那么如何来解决这些定义的差异呢？Vim的解决方案是，使用以下选项来定义哪些是一个单词的，而哪些又不是。

  ```
  查看当前选项，可以使用下面的命令：
  :set iskeyword?
  命令会返回一组用逗号分隔的值
  iskeyword=@,48-57,_,192_255  这个其实是192-255
  
  如果我们想要单词中的字母是专一的元音，可以使用以下命令：
  :set iskeyword=a,e,i,o,u
  
  我们还可以使用横线来指定字母的范围。如果要指定所有的小写字母，可以用下面的命令
  :set iskeyword=a-z
  
  对于那些不能直接指定的字符，可以使用十进制的数字来表示。如果我们要指定小写字母和下划线为一个单词，可以使用下面的命令：
  :set iskeyword=a-z,45
  
  排除某一个字符，可以在这个字符前加上一个前缀^。例如我们可以定义一个单词由除了q以外的小写字符组成：
  :set iskeyword=@,^q
  
  iskeyword（命令iskeyword可以简记为isk）选项使用以下特殊字符：
  a 字符
  aa-z 所有由a到z的字符
  @ 由函数isalpha()所定义的所有字符
  @-@ 字符@
  ^x 除了x以外的字符
  ^a-c 除了a到c以外的字符
  ```

- 可以使用:help iskeyword命令，查看更多帮助信息。

###### 在WORD间移动

- [count]B 向后移动count个WORDS

  [count]E 向前移动count个WORDS,并且将光标置于WORD的末尾.

  [count]gE 向后移动count个WORDS,并且将光标置于WORD的末尾.

  [count]W 向前移动count个WORDS.

- 可以使用:help word-motions命令，查看在词间移动的更多帮助信息。

##### 文本对象

- 在Vim中，相比针对单个字符进行操作，对于单词、句子和段落等更大范围的文本对象（**text-objects** ）执行命令则更有效率。Vim的命令结构示例如下：

  ```
  [number]<command>[text object or motion]
  ```

  - 其中：number是指命令作用在几个文本对象之上。比如3个单词；command是指执行的具体命令。比如删除或复制；text object or motion是指具体的文本对象。比如单词、句子或段落。

- 文本对象命令只能在可视模式或操作符后使用。这些命令或以 "a" 打头，代表选择一个 ("a"n) 包含空白的对象；或以 "i" 带头，代表选择内含 ("i"nner) 对象: 它们不包含空白。另外，空白本身也是内含对象。这样，"内含" 对象总比 "一个" 对象选择较少的文本。
- 文本对象就是符合某一标准的在某两个界定符内的一串文本，比如一个单词，一个句子，一个字符串等。文本对象有二个优点，一是无论光标处于该文本对象的哪个字符中，你可以对整个文本对象进行操作；二是有些情况下你想要进行的操作正好就是一个文本对象的全部内容。
- 操作＋对象范围＋文本对象界定符
  - 单词和句子的界定符用 `w` 和 `s` 来表示，其它的用两个界定符中的任何一个都可以表示。如 `daw` 表示删除一个单词，`yis` 表示复制一个句子。`yi(`表示复制一个括号中的内容。
  - 操作有三种：v、y、d，分别为，选中、复制、删除；c命令是一个动作后面要跟具体的文本对象例如ciw
  - 文本对象共有两个范围，一是a，其实它就是英语单词a，表示一个文件对象，对该文本对象的操作会包括文件对象的界定符，如双引号字符串的双引号，括号，尖括号等。第二个是i，是英语单词inner的缩写，所以这表示操作范围在一个对象之内，不包括界定符。
- 文本对象类型
  - iw …inner word
  - aw …a word
  - iW …inner WORD
  - aW …a WORD
  - is …inner sentence
  - as …a sentence
  - ip …inner paragraph
  - ap …a paragraph
  - it …inner tag
  - at …a tag
  - i( or i) …inner block
  - a( or a) …a block
  - i< or i> …inner block
  - a< or a> …a block
  - i{ or i} …inner block
  - a{ or a} …a block
  - i[ or i] …inner block
  - a[ or a] …a block
  - i" …inner block
  - a" …a block
  - i` …inner block
  - a` …a block
- 应用实例
  - 使用ci)命令，可以删除括号内的所有内容，但保留括号本身。而ca)命令，则可以删除括号内的所有内容，以及括号本身。
  - 在某个开括号上，点击%键，光标将可以自动移动到相对应的闭括号上。通过与编辑命令组合，c%可以实现与ca)相同的功能。使用%命令，必须将光标放在括号之上；而使用a)命令，则光标可以在括号之上或括号内的任何位置。而且%命令，也是无法实现用i)命令效果的。
  - 使用cit命令，你甚至不用将光标移动到Tag之内，就可以快速修改其中的内容。这个是相对于XML格式上来说的。

##### 文本对象间移动

- 使用以下命令，可以按照[文本对象](https://link.zhihu.com/?target=https%3A//yyq123.github.io/learn-vim/learn-vi-10-TextObjects.html)（Text Objects）为单位来快速移动；同时，对于浏览C、Java代码和HTML、Markdown等标签语言文档，也更加友好和高效。当然，以下命令也接受[count]参数，以跳转多个对象。

  ![](https://pic1.zhimg.com/80/v2-f068c5ddf914159f5649f37c90ea8bdc_720w.jpg)

- 句子（sentence），是以 '.'、'!' 或者 '?' 结尾并紧随着一个换行符、空格或者制表符。结束标点和空白字符之间可以出现任何数量的闭括号和引号: ')'、']'、'"' 和 '''。段落和小节的边界也视为句子的边界。

- 段落（paragraph），是以每个空行或段落宏命令开始，段落宏由 'paragraphs' 选项里成对出现的字符所定义。它的缺省值为 "IPLPPPQPP TPHPLIPpLpItpplpipbp"，也就是宏 ".IP"、".LP"等 (这些是 nroff 宏，所以句号一定要出现在第一列)。小节边界也被视为段落边界。注意，空白行不是段落边界。

- 小节（section），是以每个首列出现的换页符（<C-L>，<FF>）或小节宏命令开始。小节宏由 'sections' 选项里成对出现的字符所定义。它的缺省值是 "SHNHH HUnhsh"，也就是宏 ".SH"、".NH"、".H"、".HU"、".nh" 和 ".sh"。

- 按其他对象移动

  <img src="https://pic4.zhimg.com/80/v2-e8d6119a6e4c954c01848c8f181b3557_720w.jpg" style="zoom:50%;" />

  - 绿色，标志光标初始位置；

  - 红色，标志光标移动到的目的位置；

  - 橙色，标志光标移动的轨迹；

    <img src="https://pic2.zhimg.com/80/v2-33ab7e788ec62c83bc035b7cffa52c95_720w.jpg" style="zoom:50%;" />

- [上面图片来源](https://of-vim-and-vigor.blogspot.com/2012/11/vim-motions.html)

##### 匹配成对字符

###### matchpairs

- matchpairs选项，用来控制哪些字符可以通过`%`命令进行匹配。此选项的默认值如下：

  ```
  :set matchpairs=(:),{:},[:]
  ```

  - 也就是说，在开括号“(,{,[”上点击`%`键，将会自动跳转到对应的闭括号“),},]”上；同理，在闭括号上点击`%`键，也会跳转回到对应的开括号上；同时，匹配跳转也能够正确处理括号嵌套的情况。
  - 如果当前光标下并非括号，那么点击`%`键，将自动在本行内向前查找并定位到括号之上。

- 如果需要新增匹配类型，例如增加对于HTML文件中的尖括号的匹配，那么可以使用以下命令：

  ```
  :set mps+=<:>
  ```

- 利用[自动命令](https://link.zhihu.com/?target=http%3A//yyq123.github.io/learn-vim/learn-vi-49-01-autocmd.html)（autocmd），可以针对特定文件类型设置匹配字符。例如针对C和Java代码，增加对于“=”和“;”的匹配：

  ```
  :au FileType c,cpp,java set mps+==:;
  ```

###### showmatch

- 如果希望在输入闭括号时，短暂地跳转到与之匹配的开括号，那么可以设置以下选项：

  ```
  :set showmatch
  ```

###### matchtime

- 'matchtime'选项，用于控制显示配对括号的时间，其单位为0.1秒，默认值为5，即0.5秒。

  ```
  如果希望持续显示配对括号1.5秒，那么可以使用以下命令：
  :set matchtime=15
  ```

###### matchit插件

- [matchit](https://link.zhihu.com/?target=https%3A//github.com/chrisbra/matchit)插件扩展了`%`命令的功能，支持if/else/endif语法结构；支持HTML标签。使用`:help matchit-languages`命令，可以查看当前支持的所有语言列表。

- 从Vim 6.0开始，[matchit](https://link.zhihu.com/?target=https%3A//github.com/chrisbra/matchit)插件伴随vim发行，内置于`$VIMRUNTIME\pack\dist\opt\matchit`目录中，并不需要单独安装。

- 在[vimrc](https://link.zhihu.com/?target=http%3A//yyq123.github.io/learn-vim/learn-vi-59-vimrc.html)配置文件中增加以下命令，可以启用matchit插件：

  ```
  packadd! matchit
  ```

##### ctrl+F设置

- 在Linux下的Vim中，Ctrl-F键默认设置为，向前（Forward）滚动屏幕；而在Windows和Mac下的Vim中，Ctrl-F键默认设置为，打开查找对话框。

- 此设置是在2017年2月9日发布的8.0.0321版本中开始生效的。通过查看 "C:\Program Files (x86)\Vim\vim81\mswin.vim" 文件，可以发现 Ctrl-F 被设置为打开查找对话框。

- 为了保持不同操作系统之间的操作一致性，建议在[配置文件(vimrc)](https://link.zhihu.com/?target=http%3A//yyq123.github.io/learn-vim/learn-vi-59-vimrc.html)中增加以下代码，以重新将Ctrl-F键设置为向前滚动屏幕：

  ```
  unmap <C-F>
  ```

  - 注意，以上设置命令必须放置在以下载入代码之后，以确保设置不会被覆盖：

    ```
    source $VIMRUNTIME/mswin.vim 
    ```

##### 滚动屏幕

- 命令CTRL-U可以向上翻滚半屏，但是可以通过设置scroll选项来控制这个命令翻滚的行数。例如命令:set scroll=10可以使得Vim一次翻滚10行。也可以通过改变CTRL-U命令的参数来改变翻滚的行数。例如命令2CTRL-U可以使得Vim一次向上翻滚两行。
- 当光标到达窗口上端或下端时，窗口要发生滚动。我们可以通过设置scrolljump选项来控制这个翻滚行数的大小，默认情况下为1。例如命令:set scrolljump=5将翻滚量设为5。与其相类似的就是sidescroll选项，所不同是后者控制水平的翻滚。
- 通常情况下，窗口翻滚是在光标到达窗口顶部或底部时才发生的。我们可以通过scrolloff选项来控制光标与顶部或是底部有多少距离时发生。例如命令:set scrolloff=3将值设为3，当光标与顶部距离为三行时发生翻滚，且翻滚后光标与底部相距三行。

###### 放置行

- 有时我们希望将指定的行放在屏幕顶端。先将光标放在指定的行上，然后输入z<Enter>，这一行就会出现在屏幕的顶端了。我们还可以利用参数将指定的行置于屏幕顶端。例如命令8z<Enter>就是将第八行置于屏幕顶端。这个命令将指定的行置于顶端，并将光标移动到本行第一个非空白字符处。如果要将指定行置于顶端，并将光标保持在一行的当前位置不变，可以使用zt命令。

- 如果要将指定的行放在屏幕底部，可以使用命令z-或是zb。所不同的是，前者将光标放在这一行中第一个没有空白符的字符处，而后者是保持光标的位置不变。

- 命令zz或是z.可以将指定的行放在屏幕的中部。这两个命令的不同就是，前者保持光标的位置不变，而后者是将光标置于第一个非空白的字符处。

- H将光标移动到屏幕顶端， M移动到屏幕中间，L移动到屏幕底部

  ![](https://pic4.zhimg.com/80/v2-8071b9a8aa606a05441a6166e422c5bb_720w.png)

##### 寄存器

- 将寄存器与各种删除、复制、粘贴命令组合使用，能够大大提高编辑文本的效率。

###### 指定寄存器

- 在复制或删除文本时，可以使用"register命令将文本放入指定的寄存器中。例如以下命令，将复制的文本放到寄存器*a*中，同时文本也会被放入未命名寄存器中。

  ```
  "ayy
  ```

- 如果再使用相应的大写字母来指定寄存器，那么会将当前行内容追加到寄存器*a*中，这时该寄存器中就有了两行文本。

  ```
  "Ayy
  ```

###### 查看寄存器

- 使用registers name命令，可以查看特定寄存器中的内容：

  ```
  registers a
  ```

- 如果想要查看所有寄存中的内容，可以使用以下命令：

  ```
  :registers
  ```

###### 寄存器类别

<img src="https://pic3.zhimg.com/80/v2-9752311b4c4e51ddb02f59ce25e4830e_720w.jpg" style="zoom:80%;" />

- **未命名寄存器（The Unnamed Register）** 当使用y命令复制文本，或使用d、c、s、x等命令删除文本时，文本将自动被放入**""**未命名寄存器。即使你在复制或删除文本时，已经指定了寄存器（例如使用"xdd命令），这些文本也将同时被放入"x和""寄存器。
- **数字寄存器（The Numbered Registers）** **"0**包含最近复制的文本；**"1**包含了最近删除或者修改的文本。区别在于："0不断被复制的文本所覆盖；而在删除文本时，如果指定了寄存器或者文本小于一行，那么"1将不会被覆盖。数字寄存器1-9可以看作是删除历史， 你可以从中找到早先删除的文本。比如使用了三次`dd`命令，那么这三行文本被分别存放在寄存器1,2,3中，可以通过命令`"1P`,`"2P`,`"3P`将这些文本再粘贴回来。
- **行内删除寄存器（The Small Delete Register）** 当删除文本少于一行时，内容将被放入**"-**寄存器，除非指定了其它寄存器。
- **命名寄存器（The Named Registers）** 当文本被放入以小写字母命名的寄存器（例如**"a**）时，该寄存器原有的内容将被覆盖；而使用以大写字母命名的寄存器（例如**"A**）时，将会把文本追加到原有内容之后。
- **只读寄存器（The Read-Only Registers）** 你只能从只读寄存器中粘贴内容，而不能放入文本。**"%**包含当前文件名；**".**包含最近插入的文本；**":**包含最近执行的命令行。
- **轮换文件寄存器（The Read-Only Registers）** **"#**包含当前窗口轮换文件的名字。它影响CTRL-^的工作方式。
- **表达式寄存器（The Expression Register）** 可以进行表达式计算并返回结果。在常规模式下，输入**"=**，就会在Vim底部显示以“=”开始的提示行，可以在其中输入表达式并按回车键确认。随后使用命令`p`，可以将表达式的结果粘贴到文本中。例如在`=`提示符后输入“5*5”并按回车，然后输入命令p，就可以将计算结果“25”插入文本中了。在插入模式下，点击Ctrl-R=快捷键，也可以进入`=`提示行，输入表达式然后点击回车键，将计算结果插入到当前光标处。也就是说，不用离开插入模式，也无需额外执行粘贴命令，即可以完成表达式计算。在表达式寄存器中，不仅可以使用通常的算术运算符，还可以使用Vim特定的函数和运算符。例如通过表达式寄存器来得到环境变量的值（例如"=$HOME）。如果没有输入任何表达式而直接按回车键，那么Vim将执行最近使用过的表达式。
- **选择和拖拽寄存器（The Selection and Drop Registers）** 有3个寄存器用于保存选中的文本：在Mac和Windows下，**"\***和**"+**，都用于访问系统剪切板；在Linux下，**"+**用于访问系统剪切板，而**"\***包含选中的文本。使用`"+y`命令，可以将当前选中的文文本复制到系统剪切板中。而`"+p`命令，则可以粘贴系统剪切板中的内容。通过剪切板寄存器，能够在不同的Vim编辑器或者是其他应用程序之间，进行文本交换。**"~**包含上次从其它应用程序拖拽到Gvim中的文本。
- **搜索模式寄存器（Search Pattern Register）** 当通过`/`命令进行搜索时，所使用的模式将被自动放入**"/**寄存器。

###### 粘贴寄存器

- 命令:put会将寄存中的内容粘贴到指定的文本行后面。使用以下命令，可以将寄存器中的内容粘贴到第五行的后面:

  ```
  :5put a
  ```

- 如果要将文本放在这一行的前面，可以用以下命令：

  ```
  :5put! a
  ```

- 你也可以使用p命令，将x寄存中的文本粘贴到光标之后：

  ```
  "xp
  ```

- 而P命令，则将x寄存中的文本粘贴到光标之前：

  ```
  "xP
  ```

- 如果直接使用p或P命令，而没有指明特定寄存器，那么将粘贴未命名寄存器中的内容。

- 使用以下命令，可以粘贴上次插入的文本，方便你录入重复的内容：

  ```
  ".P
  ```

- 如果要粘贴系统剪切板中的内容，在Insert mode下可以利用快捷键Shift+Ins，而在Normal mode下，可以使用以下命令：

  ```
  "*p
  ```

- 在插入模式下，点击CTRL-R然后输入寄存器的标识符，可以粘贴相应寄存器中的内容到当前位置。例如：

  ```
  CTRL-R: 将粘贴最近执行的命令；
  
  CTRL-R/ 将粘贴最近使用的搜索模式；
  
  CTRL-R0 将粘贴"0寄存器的内容；
  
  CTRL-Ra 将粘贴"a寄存器的内容。
  ```

- 使用以下命令，可以查看相关帮助信息：

  ```
  :help i_CTRL-R 
  ```

##### 重复命令

- .（Dot）命令，可以重复上次的修改。而上次的修改，可以是针对单个字符、整行，甚至是整个文件。所以Dot命令，是一个作用范围极广的强大命令。

###### 重复单个命令

- .命令重复执行了x命令，用于删除当前光标下的字符

  ![](https://pic1.zhimg.com/80/v2-ae1ed3b31455ad6823c8b3f896902948_720w.png)

- .命令重复作用于整行之上的删除操作

  ![](https://pic2.zhimg.com/80/v2-26a6dc54a85e277a94e1678593e0abb5_720w.png)

###### 重复多个命令组合

- 假设我们有以下代码：

  ```
  var foo = 1
  var bar = 'a'
  var foobar = foo + bar
  ```

  - 如下图所示：首先，我们使用A命令进入插入模式并在当前行的末尾增加分号；然后，退回到常规模式；之后，移动到一下行并利用.命令重复插入分号的操作。

    ![](https://pic4.zhimg.com/80/v2-744e645261febcfc56bfaf14b97adc77_720w.png)

###### 重复命令与其他命令的组合

- 假设我们有以下代码：

  ```
  var foo = "method("+argument1+","+argument2+")";
  ```

  - 在以下实例中：我们希望在每个加号前后分别插入空格，以提高代码的可读性。首先，我们使用f命令查找加号；然后，使用s命令将加号替换为“ + ”；随后，退回到常规模式；之后，就可以利用;.命令查找下一个加号并重复执行替换操作。

    ![](https://pic3.zhimg.com/80/v2-b24817322b00d67481fba70739bf652a_720w.png)

- 还得使用；来查找下一个加号然后使用.命令

##### 持久性撤销

- 持久性撒消（persistent undo），会将撒消树保存到撤销文件中，因而即使被编辑文件被关闭再打开多次，也可以撤销过去进行的所有修改（当然不能超过[undolevel](https://link.zhihu.com/?target=http%3A//vimdoc.sourceforge.net/htmldoc/options.html%23'undolevels')的限制）。

###### 启用持久性撤销

- 默认情况下，Vim并没有启用持久性撤销。使用以下命令，可以启用持久性撤销：

  ```
  set undofile 
  ```

  - Vim将为正在编辑的文件，分别创建独立的撤销文件，用以保存支持撤销操作的信息。

###### 生成撤销文件

- 撤销文件通常保存在文件本身所在的目录里。使用以下命令，可以将撤销文件集中保存到指定的目录：

  ```
  set undodir=$HOME/.vim/undodir
  ```

  - 请注意，需要确保您指定的目录已经存在。
  - 生成的撤销文件，将以所编辑文件的完整名称命名。其中包括了完整的路径名，其中“/”将以“%”代替：

- Vim只会创建撒消文件，而永远不会去删除它们；如果你更改了文件名称，那么旧文件名所对应的撤销文件也不会被自动删除。建议，将撤销文件存储到指定目录（比如temp临时目录），并定期进行手动清理。

###### 撤销操作

- 使用:earlier {N}f 和 :later {N}f 命令，可以根据写入次数进行撤销。

  ```
  例如以下用命令，可以恢复到上次写入时的文本状态
  :earlier 1f
  ```

- 使用`:help persistent-undo`命令，可以查看关于持久性撤消的[帮助信息](https://link.zhihu.com/?target=http%3A//vimcdoc.sourceforge.net/doc/undo.html%23undo-persistence)。

##### 运行外部命令

- 使用`:!`命令，可以运行一个外部系统命令。例如，以下命令将打开终端窗口，并在其中显示当前日期：

  ```
  :!date
  ```

- 使用`:!!`命令，可以重新执行最近一次运行过的命令。

- 使用`!!`命令，可以运行外部命令并将输出结果做为当前行的内容。例如，输入`!!date`命令，将会把date命令的输出结果插入到文件中，当前行中的原有内容将会被覆盖。

###### 读取命令输出

- 在常规模式下，使用`:read`命令，可以读取命令执行的输出结果。例如以下命令，将在当前行之下新增一行并插入当前日期。

  ```
  :read!date (For Linux)
  
  :read!date /t (For Windows)
  ```

###### 调用命令终端

- 使用`:shell`命令，不需要退出Vim，就可以打开操作系统的命令终端窗口，并在其中执行一个或多个Shell命令。在终端中使用`exit`命令，则可以退回到Vim。
- 使用Vim8引入的`:terminal`命令，将在新建的水平分割窗口中进入命令终端。也可以使用`:vertical :term`命令，在新建的垂直分割窗口中进入命令终端。
- 如果无法正常调用:terminal命令，那么请使用`:version`命令，查看是否包含**+terminal**关键字，以确认在当前版本Vim中已启用此特性。
- 在命令终端中，点击**`Ctrl-\-N`**快捷键，将从Terminal-Job模式切换至Terminal-Normal模式。在Terminal-Normal模式下，可以像在Vim常规模式下一样，使用光标键或命令来移动光标，也可以使用鼠标或命令来选择和复制文本，以便于将命令输出复制到其他文件。点击**i**键，则可以返回Terminal-Job模式，继续执行命令。上面这个快捷键是按着ctrl在按\然后按N键

###### QuickFix

- 某些Vim命令，将会使用QuickFix列表在不同文件的不同位置间导航。例如：使用:make命令进行编译时，遍历编译错误；使用:vimgrep命令进行搜索时，遍历匹配结果；使用:helpgrep命令查找[帮助信息](https://link.zhihu.com/?target=http%3A//yyq123.github.io/learn-vim/learn-vi-08-help.html)时，遍历匹配的主题。

- 执行以下命令，将在当前文件夹中的所有HTML文件中，搜索字符串“options”：

  ```
  :vimgrep options *.html
  ```

  - 在屏幕底部，将显示查找到的第一个匹配结果：

- 输入`:copen`或`:cwindow`命令，将在水平分隔窗口中，打开QuickFix列表以显示所有匹配结果：你可以使用ctrl+Wj快捷键，移动到QuickFix窗口。关于在多个窗口之间的跳转操作，请参阅[窗口(Window)](https://link.zhihu.com/?target=http%3A//yyq123.github.io/learn-vim/learn-vi-14-MultiWindows.html)章节。

- 使用以下快捷键，可以在QuickFix列表中进行移动或搜索；当到达想要查看的列表项时，点击Enter键，将会打开匹配文件并精确定位到查找结果所处的位置。

- k向上移动↑j向下移动↓Ctrl+b向上翻页pageUpCtrl+f向下翻页PageDown/string向前（Forward）查找字符串string?string向后（Backward）查找字符串string

- 注意，如果您在Windows和Mac下，无法利用Ctrl+f键进行翻页，那么请重新恢复[Ctrl-F设置](https://link.zhihu.com/?target=https%3A//yyq123.github.io/learn-vim/learn-vi-11-01-Scroll-CtrlF.html)。

- 你也可以使用以下命令，直接跳转到匹配文件的查找结果所处位置：

  ```
  :cnext移动到下一个匹配处
  :cprevious移动到上一个匹配处
  :cfirst移动到第一个匹配处
  :clast移动到最后一个匹配处
  ```

- 使用以下命令，可以关闭QuickFix窗口：

  ```
  :cclose
  ```

- 使用`:help quickfix`命令，可以查看关于QuickFix的更多帮助信息。

### 模式详解

##### 插入模式

- ```
  i在光标之前，进入插入模式
  I在本行开头，进入插入模式
  a在光标之后，进入插入模式
  A在本行结尾，进入插入模式
  o在本行之后新增一行，并进入插入模式
  O在本行之前新增一行，并进入插入模式
  s删除当前字符，并进入插入模式
  S删除当前行中的所有文本，并进入插入模式
  
  c命令是一个动作后面要跟具体的文本对象例如ciw
  cc命令是删除本行并进入插入模式
  ```

- 通过在i，I，a，A命令中增加数字前缀，可以批量插入内容，以避免重复输入。例如：输入`50i*`命令，然后点击**Esc**键，将一次性插入50个星号；使用`25a*-`**Esc**命令，则将一次性插入25个星号和短线的组合。

- 通过在小写s命令中增加数字前缀，可以替换多个字符。例如：希望将“www.vim.org”更改为其它网址，可以首先将光标移动到字符“v”处，然后执行`3s`命令，删除3个字符并进入插入模式输入其它域名。

- 通过在大写S命令中增加数字前缀，可以替换多行内容。例如：执行`3S`命令，将删除2行文本，并将第3行文本清空，然后进入插入模式。

###### 在插入模式中编辑

- 在插入模式下，不能使用h，j，k，l键来移动光标，而必须使用光标移动键。使用以下命令，可以查看使用特殊快捷键进行移动和操作的说明：

  ```
  :help ins-special
  ```

- 在插入模式下，可以使用各种快捷键来操作文本，而不需要首先退回到常规模式，然后再执行命令。例如：使用**ctrl-U**键，可以删除光标之前的所有文字；而**ctrl-W**键，则可以删除光标之前的一个字符；使用**ctrl-T**键，可以增加缩进；而**ctrl-D**键，则可以减少缩进。请使用以下命令，查看插入模式下快捷键的更多帮助信息：

  ```
  :help ins-special-keys
  ```

- 使用**CTRL-O**快捷键，可以进入命令模式执行Vim命令，然后重新回到插入模式，以避免多次切换模式的繁琐。例如，首先使用**CTRL-O**进入命令模式，然后执行`dw`命令来删除单词，在执行完毕之后将重新回到插入模式。

- 使用以下命令，可以查看关于插入模式的帮助信息：

  ```
  :help insert.txt
  ```

- 使用以下命令，可以查看关于快速插入文本的更多技巧。比如：补全、重复插入、从另一行拷贝、插入一个寄存器内容、[缩写](https://link.zhihu.com/?target=http%3A//yyq123.github.io/learn-vim/learn-vi-52-Abbreviation.html)和[插入特殊字符](https://link.zhihu.com/?target=http%3A//yyq123.github.io/learn-vim/learn-vi-65-Listchars.html)等等：

  ```
  :help usr_24.txt 
  ```

##### 替换模式

- 使用大写`R`命令，将进入替换模式（屏幕底部显示“--REPLACE--”）。此时新输入的文本将直接替代/覆盖已经存在的内容，直至点击ESC键返回常规模式。
- 使用小写`r`命令，将进入单字符替换模式，此时新输入的字符将替代光标之下的当前字符，然后自动返回到常规模式。
- 通过在r命令中增加数字前缀，可以一次性替换多个字符。例如，将光标定位到“||”字符处，然后执行`2r&`命令，可以将其替换为“&&”。
- 使用`gR`命令，将进入虚拟替换模式（virtual replace mode）（屏幕底部显示“--VREPLACE--”），其与替换模式最主要的区别在于，对<Tab>键和换行符的不同处理方式。
- 对于<Tab>键的处理方式
  - 在替换模式（REPLACE）下，在原有<Tab>键处输入字母'a'，将直接替代<Tab>键所占用的所有空格的位置，文本格式遭到破坏：
  - 在虚拟替换模式（VREPLACE）下，在原有<Tab>键处输入字母'a'，将仅仅替代单个空格，文本格式保持不变：
  - 从以上实例可以发现：替换模式（REPLACE）将<Tab>键作为一个整体来处理（不管其真实占用多少个空格位置）；而虚拟替换模式（VREPLACE）则将<Tab>键拆分为多个独立的空格来分别处理。如果文本以<Tab>分隔排布，在编辑过程中希望保持原有的文本缩进和排版格式，那么建议使用虚拟替换模式。
- 对于<NL>换行的处理方式
  - 在替换模式（REPLACE）下，输入<Enter>回车键将增加新行：
  - 在虚拟替换模式（VREPLACE）下，输入<Enter>回车键将用新行替代当前行内容（即清空当前行）：
- 使用`gr`命令，可以进入单字符虚拟替换模式。在替换光标下的当前字符之后，将自动返回到常规模式。
- 注意上面的gR和gr命令区别

##### 可视化模式

- 在可视化模式下，可以对一个文本块的整体进行操作。例如，首先高亮选中一部分文本，然后用d命令删除这个文本块。可视化模式的好处在于，不但可以大大提高操作的效率，而且还可以在做改动之前，就看到操作将影响的文本。
- 可视化模式可以分为以下三种：
  1. 用`v`命令进入的**字符可视化模式（Characterwise visual mode)**，文本选择是以字符为单位的。
  2. 用`V`命令进入的**行可视化模式（Linewise visual mode)**，文本选择是以行为单位的。
  3. 用`ctrl-V`进入的**块可视化模式（Blockwise visual mode）**，可以选择一个矩形内的文本。（注意：在Windows中，ctrl-V可能已经被影射为粘贴操作，可以使用`ctrl-Q`进入块可视化模式。）
- 命令`gv`可以重复前一次可视化模式时选中的文本。如果已经在可视化模式下，执行该命令会选中前一次选择的文本。如果重复行执行gv命令，就会在当前选中的文本和前一次选中的文本之间进行切换。

###### 在可视化模式下移动

- 如果你已经在可视化模式下选择了若干文本，并且希望移动到已选择文本的另一结尾处，那么可以使用`o`命令。
- 如果你使用的是块可视化模式，那么已选择的区域将有四个角落。`o`命令只能移动到对面的一个角落，这时你可以使用`O`命令移动到同一行的另一个角落。
- 这样如果选择的块中行不是很整齐，我们就可以移动到其他的位置继续选择，这样在块模式下选择出来的就可以是不平整的

###### 在可视模式下编辑

- 在可视化模式下，我们可以进行各种编辑操作。如`d`命令可以删除高亮显示的文本，而`D`命令则会删除一行，即使这一行中只有部分文本是高亮显示的。类似的，`y`命令将复制高亮显示的文本，而`Y`命令会复制整行。

- 在块可视化模式下，使用`c`命令将删除高亮选中的文本并进入插入模式，在你输入文本并点击Esc返回之后，输入的文本将插入到块选中的每一行里。

- 而`C`命令会删除从选中文本到行尾的所有字符并进入插入状态。

- 针对高亮显示的文本块，我们可以用命令`~`进行大小写转换。用命令`>`增加缩进，或用命令`<`减少缩进。

- 我们还可以利用可视化模式，来合并多行文本。`J`命令可以将高亮显示的文本内容合并为一行，同时以空格来分隔各行。如果不希望在行间插入空格，那么可以使用`gJ`命令。

- 使用`g?`命令，可以使用rot 13算法来加密高亮显示的文本。针对同一个文本再次执行加密命令，就可以进行文本解密。

- 在可视化模式下，按下:键就可以对选定范围进行操作。例如：我们先在可视化模式下选中文本，然后执行`:write block.txt`命令，就可以将文本块写入另一文件中。选择多行，然后执行`:sort`命令，则可以对选中的文本进行排序。

- `Istring<Esc>`命令，可以快速地在块可视化模式下添加文本。比如先用`^`命令，移动到行首；然后使用`ctrl-Q`进入块可视化模式；再利用`j`命令选中多行；而后使用`I--`命令，就可以在每行开头增加注释符。如果选中文件按i(小写的)就会删除选中的

- 如果在块可视化模式下，仅仅选中了某些行，那么`Ivery<Esc>`命令将不会改变未选中的行。Ivery表示先按I然后输入very

  ![](https://pic3.zhimg.com/80/v2-7bd7d985e609855395fd5fe29dfec5da_720w.jpg)

- 在块可视化模式下，使用`r`命令，然后输入单个字符，将会把所有已选中的字符都替换为输入的字符。如果仅仅选中了某些行，那么未选中的行将不会受到影响。输入单个字符，例如按一个x，表示将所有选中的字符变为x
- 在块可视化模式下，使用`A`命令，然后输入字符，输入的字符将会被添加到块之后。即使仅仅选中了某些行，但是未选中的行也会受到影响。

##### 命令行模式

- 输入`:`命令，使用`/`或`?`搜索命令，都将进入命令行模式。用户可以在屏幕底部的命令行中输入命令，或者使用以下快捷键遍历之前的命令历史，然后点击<Enter>键来执行命令。

  <img src="https://pic1.zhimg.com/80/v2-eb1966f79ad64badb9b792e68b1519b4_720w.jpg" style="zoom:67%;" />

- 输入部分命令，比如输入`:set`，然再点击上下光标键，将自动对命令历史纪录进行过滤，仅显示以“set”开头的命令历史纪录。在输入`/`和`?`查找命令时，此特性同样有效。请注意，此时是大小写敏感的。

- 继续键入命令`:set i`之后，按下Tab或Ctrl+D键，将显示以“i”开头的set命令；继续按Tab键，则可以在这些命令列表间移动，按下回车键就可以执行该命令。这样我们可以看到set设置的命令，不需要那么死记硬背了

- 进入命令行模式之后，点击Ctrl+rCtrl+w键可以将当前光标下的[word](https://link.zhihu.com/?target=https%3A//yyq123.github.io/learn-vim/learn-vi-09-word.html)粘贴到命令行中；点击Ctrl+rCtrl+a键可以将当前光标下的[WORD](https://link.zhihu.com/?target=https%3A//yyq123.github.io/learn-vim/learn-vi-09-word.html)粘贴到命令行；点击Ctrl+r%键可以将当前文件名粘贴到命令行。

- 利用以上快捷键，可以大大简化命令行的输入。比如想要替换光标下的单词，那么只要输入:substitute命令，然后再点击Ctrl+r和Ctrl+w键，就可以将光标下的单词插入到命令行中，而不需要手工输入替换的文字了。

  ```
  :%s/<Ctrl+r><Ctrl+w>//g
  ```

- 比如在编辑[vimrc配置文件](https://link.zhihu.com/?target=http%3A//yyq123.github.io/learn-vim/learn-vi-59-vimrc.html)时，会面对大量的设置命令，只需要将光标移动到配置选项之上，输入:help命令，然后点击Ctrl+r和Ctrl+w键，就可以查询该关键字的帮助信息：

  ```
  :help <Ctrl+r><Ctrl+w>
  ```

- 使用`:help c_CTRL-R_CTRL-W`命令，可以查看关于Ctrl+r和Ctrl+w键的帮助信息。使用`:help cmdline-editing`命令，可以查看关于命令行编辑的帮助信息。使用`:help :`命令，可以查看关于命令行模式的帮助信息。

###### 命令行窗口

- 可以使用以下四种方式，来打开命令行窗口：

  - 在命令行模式下，使用CTRL-F快捷键打开命令行窗口，并显示命令历史纪录；
    请注意，您可以使用`:set cedit`命令，更改此快捷键。
  - 在常规模式下，使用`q:`命令打开命令行窗口，并显示命令历史纪录；
  - 在常规模式下，使用`q/`命令打开命令行窗口，并显示向前查找（search forward）的历史纪录；
  - 在常规模式下，使用`q?`命令打开命令行窗口，并显示向后查找（search backward）的历史纪录；

- 我们可以将命令行窗口，视为常规的[缓冲区 (Buffer)](https://link.zhihu.com/?target=http%3A//yyq123.github.io/learn-vim/learn-vi-13-MultiBuffers.html)来操作。使用k和j键，可以在命令历史纪录中上下移动；也可以使用`/`命令查找命令历史纪录，并在此基础上进行修改，然后点击<Enter>键来执行命令（命令行窗口也将同时关闭）。

- 如果同时打开多个[缓冲区 (Buffer)](https://link.zhihu.com/?target=http%3A//yyq123.github.io/learn-vim/learn-vi-13-MultiBuffers.html)，那么可以在一个缓冲区的命令行窗口使用`yy`命令复制一条命令，然后在另一个缓冲区的命令行窗口中粘贴并执行该命令，或者在命令行中使用`:@"<CR>`来执行复制的命令。也就是说，你可以很方便地在多个缓冲区中，重复执行命令（比如相同的:%s/old/new/g替换操作），而不必多次手工输入命令。

- 使用以下命令，可以设置命令行窗口的高度（默认值为7）：

  ```
  :set cmdwinheight=n
  ```

- 使用`:help command-line-window`命令，可以查看命令行窗口的更多帮助信息。

